<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --secondary: #64748b;
            --success: #22c55e;
            --danger: #ef4444;
            --warning: #f59e0b;
            --background: #f8fafc;
            --surface: #ffffff;
            --text: #0f172a;
            --border: #e2e8f0;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
        }
        
        .app-container {
            width: 100%;
            max-width: 1200px;
            height: 90vh;
            background: var(--surface);
            border-radius: 32px;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
        }
        
        .menu-btn, .send-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: none;
            background: rgba(255,255,255,0.2);
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .menu-btn:hover, .send-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }
        
        .menu-btn:active, .send-btn:active {
            transform: scale(0.95);
        }
        
        .title {
            font-size: 20px;
            font-weight: 600;
        }
        
        /* Sidebar */
        .sidebar {
            position: absolute;
            top: 0;
            right: -320px;
            width: 300px;
            height: 100%;
            background: var(--surface);
            box-shadow: -4px 0 20px rgba(0,0,0,0.1);
            transition: right 0.3s ease;
            z-index: 1000;
            padding: 24px;
            overflow-y: auto;
        }
        
        .sidebar.open {
            right: 0;
        }
        
        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--border);
        }
        
        .close-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--border);
            color: var(--text);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .close-btn:hover {
            background: var(--secondary);
            color: white;
        }
        
        .sidebar-item {
            padding: 16px;
            margin-bottom: 8px;
            background: var(--background);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .sidebar-item:hover {
            background: var(--primary);
            color: white;
            transform: translateX(-4px);
        }
        
        .language-list {
            margin-top: 8px;
            margin-right: 20px;
            display: none;
        }
        
        .language-list.show {
            display: block;
        }
        
        .language-item {
            padding: 10px 16px;
            margin: 4px 0;
            background: var(--background);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .language-item:hover {
            background: var(--primary);
            color: white;
        }
        
        .language-item.active {
            background: var(--primary);
            color: white;
            font-weight: 600;
        }
        
        /* Answer Area */
        .answer-area {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            background: var(--background);
        }
        
        .answer-container {
            background: var(--surface);
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 4px 6px -2px rgba(0,0,0,0.05);
            min-height: 200px;
            white-space: pre-wrap;
            line-height: 1.8;
            font-size: 16px;
        }
        
        .domain-badge {
            display: inline-block;
            padding: 4px 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 16px;
        }
        
        .ai-badge {
            display: inline-block;
            padding: 4px 12px;
            background: var(--secondary);
            color: white;
            border-radius: 20px;
            font-size: 12px;
            margin-right: 8px;
        }
        
        /* Input Area */
        .input-area {
            background: var(--surface);
            border-top: 2px solid var(--border);
            padding: 16px 24px;
        }
        
        .input-container {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        #question {
            flex: 1;
            padding: 16px;
            border: 2px solid var(--border);
            border-radius: 16px;
            font-size: 16px;
            resize: vertical;
            min-height: 80px;
            transition: all 0.3s;
        }
        
        #question:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(37,99,235,0.1);
        }
        
        .keyboard-toggle {
            width: 100%;
            padding: 12px;
            background: var(--background);
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            margin-bottom: 12px;
        }
        
        .keyboard-toggle:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .math-keyboard {
            display: none;
            background: var(--background);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
        }
        
        .math-keyboard.show {
            display: block;
        }
        
        .keyboard-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
        }
        
        .key-btn {
            aspect-ratio: 1;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--surface);
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text);
        }
        
        .key-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: scale(1.05);
        }
        
        .key-btn:active {
            transform: scale(0.95);
        }
        
        /* Loading */
        .loading {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .app-container {
                height: 95vh;
                border-radius: 24px;
            }
            
            .keyboard-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .sidebar {
                width: 280px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="header">
            <button class="menu-btn" onclick="toggleSidebar()">â˜°</button>
            <div class="title" id="app-title">Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ</div>
            <button class="send-btn" onclick="sendQuestion()">â¡ï¸</button>
        </div>
        
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3 id="menu-title">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</h3>
                <button class="close-btn" onclick="toggleSidebar()">âœ•</button>
            </div>
            
            <div class="sidebar-item" onclick="toggleLanguages()">
                <span>ğŸŒ</span>
                <span id="language-label">Ø§Ù„Ù„ØºØ©</span>
            </div>
            <div class="language-list" id="language-list">
                <div class="language-item active" onclick="changeLanguage('ar')">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</div>
                <div class="language-item" onclick="changeLanguage('en')">ğŸ‡¬ğŸ‡§ English</div>
                <div class="language-item" onclick="changeLanguage('de')">ğŸ‡©ğŸ‡ª Deutsch</div>
                <div class="language-item" onclick="changeLanguage('tr')">ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e</div>
                <div class="language-item" onclick="changeLanguage('fr')">ğŸ‡«ğŸ‡· FranÃ§ais</div>
                <div class="language-item" onclick="changeLanguage('ru')">ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹</div>
            </div>
            
            <div class="sidebar-item" onclick="showHelp()">
                <span>â“</span>
                <span id="help-label">Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©</span>
            </div>
            
            <div class="sidebar-item" onclick="showAbout()">
                <span>â„¹ï¸</span>
                <span id="about-label">Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</span>
            </div>
        </div>
        
        <!-- Answer Area -->
        <div class="answer-area" id="answerArea">
            <div class="answer-container" id="answerContainer">
                <div id="answerContent">Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø³Ù‡Ù… Ù„Ù„Ø¥Ø±Ø³Ø§Ù„</div>
            </div>
        </div>
        
        <!-- Input Area -->
        <div class="input-area">
            <div class="input-container">
                <textarea id="question" rows="3" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..."></textarea>
            </div>
            
            <button class="keyboard-toggle" onclick="toggleKeyboard()" id="keyboardBtn">
                âŒ¨ï¸ Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
            </button>
            
            <div class="math-keyboard" id="mathKeyboard">
                <div class="keyboard-grid">
                    <!-- Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ -->
                    <button class="key-btn" onclick="insertSymbol('7')">7</button>
                    <button class="key-btn" onclick="insertSymbol('8')">8</button>
                    <button class="key-btn" onclick="insertSymbol('9')">9</button>
                    <button class="key-btn" onclick="insertSymbol('/')">Ã·</button>
                    <button class="key-btn" onclick="insertSymbol('^')">^</button>
                    <button class="key-btn" onclick="insertSymbol('âˆš')">âˆš</button>
                    
                    <!-- Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ -->
                    <button class="key-btn" onclick="insertSymbol('4')">4</button>
                    <button class="key-btn" onclick="insertSymbol('5')">5</button>
                    <button class="key-btn" onclick="insertSymbol('6')">6</button>
                    <button class="key-btn" onclick="insertSymbol('*')">Ã—</button>
                    <button class="key-btn" onclick="insertSymbol('(')">(</button>
                    <button class="key-btn" onclick="insertSymbol(')')">)</button>
                    
                    <!-- Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« -->
                    <button class="key-btn" onclick="insertSymbol('1')">1</button>
                    <button class="key-btn" onclick="insertSymbol('2')">2</button>
                    <button class="key-btn" onclick="insertSymbol('3')">3</button>
                    <button class="key-btn" onclick="insertSymbol('-')">âˆ’</button>
                    <button class="key-btn" onclick="insertSymbol('âˆ«')">âˆ«</button>
                    <button class="key-btn" onclick="insertSymbol('Î£')">Î£</button>
                    
                    <!-- Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹ -->
                    <button class="key-btn" onclick="insertSymbol('0')">0</button>
                    <button class="key-btn" onclick="insertSymbol('.')">.</button>
                    <button class="key-btn" onclick="insertSymbol('=')">=</button>
                    <button class="key-btn" onclick="insertSymbol('+')">+</button>
                    <button class="key-btn" onclick="insertSymbol('Ï€')">Ï€</button>
                    <button class="key-btn" onclick="insertSymbol('âˆ')">âˆ</button>
                    
                    <!-- Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³ -->
                    <button class="key-btn" onclick="insertSymbol('sin')">sin</button>
                    <button class="key-btn" onclick="insertSymbol('cos')">cos</button>
                    <button class="key-btn" onclick="insertSymbol('tan')">tan</button>
                    <button class="key-btn" onclick="insertSymbol('log')">log</button>
                    <button class="key-btn" onclick="insertSymbol('ln')">ln</button>
                    <button class="key-btn" onclick="insertSymbol('e')">e</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ============================================================
        // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
        // ============================================================
        let currentLanguage = 'ar';
        let isKeyboardVisible = false;
        
        const translations = {
            'ar': {
                'title': 'Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ',
                'menu': 'Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©',
                'language': 'Ø§Ù„Ù„ØºØ©',
                'help': 'Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©',
                'about': 'Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚',
                'keyboard_show': 'âŒ¨ï¸ Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­',
                'keyboard_hide': 'âŒ¨ï¸ Ø¥Ø®ÙØ§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­',
                'placeholder': 'Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§...',
                'default_answer': 'Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø³Ù‡Ù… Ù„Ù„Ø¥Ø±Ø³Ø§Ù„',
                'loading': 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©...'
            },
            'en': {
                'title': 'Engineering Assistant',
                'menu': 'Menu',
                'language': 'Language',
                'help': 'Help',
                'about': 'About',
                'keyboard_show': 'âŒ¨ï¸ Show Keyboard',
                'keyboard_hide': 'âŒ¨ï¸ Hide Keyboard',
                'placeholder': 'Type your question here...',
                'default_answer': 'Type your question and press the arrow to send',
                'loading': 'â³ Searching for answer...'
            },
            'de': {
                'title': 'Engineering-Assistent',
                'menu': 'MenÃ¼',
                'language': 'Sprache',
                'help': 'Hilfe',
                'about': 'Ãœber',
                'keyboard_show': 'âŒ¨ï¸ Tastatur anzeigen',
                'keyboard_hide': 'âŒ¨ï¸ Tastatur ausblenden',
                'placeholder': 'Frage eingeben...',
                'default_answer': 'Frage eingeben und Pfeil drÃ¼cken',
                'loading': 'â³ Suche nach Antwort...'
            },
            'tr': {
                'title': 'MÃ¼hendislik AsistanÄ±',
                'menu': 'MenÃ¼',
                'language': 'Dil',
                'help': 'YardÄ±m',
                'about': 'HakkÄ±nda',
                'keyboard_show': 'âŒ¨ï¸ Klavyeyi GÃ¶ster',
                'keyboard_hide': 'âŒ¨ï¸ Klavyeyi Gizle',
                'placeholder': 'Sorunuzu yazÄ±n...',
                'default_answer': 'Sorunuzu yazÄ±n ve oka basÄ±n',
                'loading': 'â³ Cevap aranÄ±yor...'
            },
            'fr': {
                'title': 'Assistant d\'ingÃ©nierie',
                'menu': 'Menu',
                'language': 'Langue',
                'help': 'Aide',
                'about': 'Ã€ propos',
                'keyboard_show': 'âŒ¨ï¸ Afficher clavier',
                'keyboard_hide': 'âŒ¨ï¸ Cacher clavier',
                'placeholder': 'Tapez votre question...',
                'default_answer': 'Tapez votre question et appuyez sur la flÃ¨che',
                'loading': 'â³ Recherche de rÃ©ponse...'
            },
            'ru': {
                'title': 'Ğ˜Ğ½Ğ¶ĞµĞ½ĞµÑ€Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰Ğ½Ğ¸Ğº',
                'menu': 'ĞœĞµĞ½Ñ',
                'language': 'Ğ¯Ğ·Ñ‹Ğº',
                'help': 'ĞŸĞ¾Ğ¼Ğ¾Ñ‰ÑŒ',
                'about': 'Ğ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸',
                'keyboard_show': 'âŒ¨ï¸ ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ ĞºĞ»Ğ°Ğ²Ğ¸Ğ°Ñ‚ÑƒÑ€Ñƒ',
                'keyboard_hide': 'âŒ¨ï¸ Ğ¡ĞºÑ€Ñ‹Ñ‚ÑŒ ĞºĞ»Ğ°Ğ²Ğ¸Ğ°Ñ‚ÑƒÑ€Ñƒ',
                'placeholder': 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ...',
                'default_answer': 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ Ğ¸ Ğ½Ğ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ÑÑ‚Ñ€ĞµĞ»ĞºÑƒ',
                'loading': 'â³ ĞŸĞ¾Ğ¸ÑĞº Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°...'
            }
        };
        
        // ============================================================
        // Ø¯ÙˆØ§Ù„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        // ============================================================
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }
        
        function toggleLanguages() {
            document.getElementById('language-list').classList.toggle('show');
        }
        
        function changeLanguage(lang) {
            currentLanguage = lang;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„ØºØ© Ø§Ù„Ù†Ø´Ø·Ø©
            document.querySelectorAll('.language-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØµÙˆØµ
            document.getElementById('app-title').textContent = translations[lang].title;
            document.getElementById('menu-title').textContent = translations[lang].menu;
            document.getElementById('language-label').textContent = translations[lang].language;
            document.getElementById('help-label').textContent = translations[lang].help;
            document.getElementById('about-label').textContent = translations[lang].about;
            document.getElementById('keyboardBtn').textContent = isKeyboardVisible ? 
                translations[lang].keyboard_hide : translations[lang].keyboard_show;
            document.getElementById('question').placeholder = translations[lang].placeholder;
            document.getElementById('answerContent').textContent = translations[lang].default_answer;
            
            // ØªØ­Ø¯ÙŠØ« Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø©
            document.body.style.direction = lang === 'ar' ? 'rtl' : 'ltr';
            
            toggleSidebar();
        }
        
        function toggleKeyboard() {
            const keyboard = document.getElementById('mathKeyboard');
            isKeyboardVisible = !isKeyboardVisible;
            keyboard.classList.toggle('show');
            document.getElementById('keyboardBtn').textContent = isKeyboardVisible ?
                translations[currentLanguage].keyboard_hide : translations[currentLanguage].keyboard_show;
        }
        
        function insertSymbol(symbol) {
            const question = document.getElementById('question');
            const start = question.selectionStart;
            const end = question.selectionEnd;
            const text = question.value;
            
            question.value = text.substring(0, start) + symbol + text.substring(end);
            question.focus();
            question.selectionStart = question.selectionEnd = start + symbol.length;
        }
        
        async function showHelp() {
            try {
                const response = await fetch(`/api/help?lang=${currentLanguage}`);
                const data = await response.json();
                document.getElementById('answerContent').innerHTML = data.help.replace(/\n/g, '<br>');
                toggleSidebar();
            } catch (error) {
                document.getElementById('answerContent').innerHTML = 'âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©';
            }
        }
        
        async function showAbout() {
            try {
                const response = await fetch(`/api/help?lang=${currentLanguage}`);
                const data = await response.json();
                document.getElementById('answerContent').innerHTML = data.about.replace(/\n/g, '<br>');
                toggleSidebar();
            } catch (error) {
                document.getElementById('answerContent').innerHTML = 'âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚';
            }
        }
        
        async function sendQuestion() {
            const question = document.getElementById('question').value.trim();
            if (!question) {
                alert(translations[currentLanguage].placeholder || 'Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø³Ø¤Ø§Ù„');
                return;
            }
            
            document.getElementById('answerContent').innerHTML = translations[currentLanguage].loading;
            
            try {
                // âœ… ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§: Ù…Ù† '/api/ask' Ø¥Ù„Ù‰ '/api/solve'
                const response = await fetch('/api/solve', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        question: question,
                        language: currentLanguage
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    let answerHtml = '';
                    
                    if (data.level) {
                        const levelNames = {
                            'simple': 'ğŸ§® Ø¢Ù„Ø© Ø­Ø§Ø³Ø¨Ø©',
                            'advanced': 'ğŸ¤– Gemini',
                            'memory': 'ğŸ’¾ Ø°Ø§ÙƒØ±Ø©'
                        };
                        answerHtml += `<div class="domain-badge">ğŸ“š ${levelNames[data.level] || data.level}</div>`;
                    }
                    
                    if (data.from_memory) {
                        answerHtml += `<span class="ai-badge">ğŸ’¾ Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø© (${data.uses || 1})</span>`;
                    }
                    
                    answerHtml += data.answer.replace(/\n/g, '<br>');
                    document.getElementById('answerContent').innerHTML = answerHtml;
                } else {
                    document.getElementById('answerContent').innerHTML = `<div style="color: #ef4444;">âŒ ${data.error || 'Ø­Ø¯Ø« Ø®Ø·Ø£'}</div>`;
                }
            } catch (error) {
                document.getElementById('answerContent').innerHTML = `<div style="color: #ef4444;">âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…</div>`;
            }
        }
        
        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
        document.getElementById('question').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendQuestion();
            }
        });
        
        // ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø¯Ø¡
        async function loadStatus() {
            try {
                const response = await fetch('/api/memory/stats');
                const data = await response.json();
                console.log('App stats:', data);
            } catch (error) {
                console.error('Failed to load stats:', error);
            }
        }
        
        loadStatus();
    </script>
</body>
</html>
