<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathCore Â· AI Engineering Assistant</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        body {
            background: #f0f4fa;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        #header {
            background: linear-gradient(145deg, #1b3b6f, #2a5599);
            color: white;
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .logo {
            font-size: 26px;
            font-weight: 700;
            letter-spacing: 1px;
        }
        .logo span {
            font-size: 14px;
            opacity: 0.9;
            display: block;
            font-weight: 400;
        }
        .lang-switch {
            display: flex;
            gap: 12px;
        }
        .lang-btn {
            background: rgba(255,255,255,0.15);
            border: 2px solid transparent;
            color: white;
            padding: 8px 20px;
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            font-size: 16px;
            transition: 0.25s;
        }
        .lang-btn.active {
            background: white;
            color: #1b3b6f;
            border-color: white;
        }
        #chat-container {
            display: flex;
            flex: 1;
            padding: 20px;
            gap: 20px;
            overflow: hidden;
        }
        #input-section {
            width: 40%;
            background: white;
            border-radius: 28px;
            padding: 22px;
            box-shadow: 0 8px 26px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
        }
        #question {
            flex: 1;
            resize: none;
            font-size: 18px;
            padding: 18px;
            border-radius: 20px;
            border: 2px solid #dde3ed;
            margin-bottom: 18px;
            font-family: 'Courier New', monospace;
            min-height: 140px;
            transition: 0.2s;
        }
        #question:focus {
            border-color: #1b3b6f;
            outline: none;
        }
        #keyboard-toggle {
            background: #eef3fc;
            padding: 16px;
            border-radius: 18px;
            font-size: 18px;
            font-weight: 600;
            color: #1b3b6f;
            text-align: center;
            cursor: pointer;
            margin-bottom: 18px;
            border: 1px solid transparent;
            transition: 0.2s;
        }
        #keyboard-toggle:hover {
            background: #d9e4f5;
        }
        #math-keyboard {
            display: none;
            background: #f8fafd;
            border-radius: 24px;
            padding: 18px 12px;
            margin-bottom: 18px;
            max-height: 260px;
            overflow-y: auto;
            border: 1px solid #cbd5e1;
        }
        .keyboard-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 12px;
        }
        .keyboard-row button {
            flex: 0 0 auto;
            min-width: 65px;
            padding: 16px 8px;
            font-size: 24px;
            font-weight: 600;
            background: white;
            border: 1px solid #bdc9db;
            border-radius: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
            cursor: pointer;
            transition: 0.15s;
            color: #0b2b4a;
        }
        .keyboard-row button:hover {
            background: #1b3b6f;
            color: white;
            border-color: #1b3b6f;
            transform: scale(1.02);
        }
        #solve-btn {
            background: linear-gradient(145deg, #1b3b6f, #2a4f8c);
            border: none;
            color: white;
            font-size: 22px;
            font-weight: 700;
            padding: 18px;
            border-radius: 40px;
            cursor: pointer;
            margin-top: 8px;
            transition: 0.2s;
            box-shadow: 0 6px 14px rgba(26, 59, 111, 0.3);
        }
        #solve-btn:hover {
            background: #15315c;
            transform: scale(1.01);
        }
        #answer-section {
            flex: 1;
            background: white;
            border-radius: 28px;
            padding: 26px;
            box-shadow: 0 8px 26px rgba(0,0,0,0.08);
            overflow-y: auto;
        }
        .domain-badge {
            background: #e5eefc;
            padding: 14px 18px;
            border-radius: 60px;
            margin-bottom: 24px;
            text-align: center;
            font-size: 17px;
            font-weight: 500;
            border: 1px solid #1b3b6f30;
            color: #1b3b6f;
        }
        .solution-card {
            background: #f7faff;
            border-radius: 36px;
            padding: 30px 20px;
            text-align: center;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.02);
        }
        #simplified-solution {
            font-size: 44px;
            font-weight: 800;
            color: #0f2b50;
            background: white;
            padding: 28px 20px;
            border-radius: 40px;
            margin: 20px 0;
            border: 1px solid #d0def0;
            word-break: break-word;
        }
        .note {
            color: #4a5f7a;
            font-size: 16px;
        }
        .message {
            padding: 14px 20px;
            border-radius: 30px;
            margin-bottom: 12px;
            max-width: 85%;
            word-wrap: break-word;
            background: #eef3fc;
        }
        .user-message {
            background: #1b3b6f;
            color: white;
            margin-left: auto;
        }
        @media (max-width: 768px) {
            #chat-container {
                flex-direction: column;
                padding: 12px;
            }
            #input-section, #answer-section {
                width: 100%;
                padding: 18px;
            }
            .keyboard-row button {
                min-width: 55px;
                font-size: 20px;
                padding: 14px 5px;
            }
            #simplified-solution {
                font-size: 34px;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div id="header">
        <div class="logo">
            MathCore
            <span data-ar="Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ Ø§Ù„Ø°ÙƒÙŠ" data-en="AI Engineering Assistant">Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ Ø§Ù„Ø°ÙƒÙŠ</span>
        </div>
        <div class="lang-switch">
            <button class="lang-btn active" onclick="switchLang('ar')" id="btn-ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
            <button class="lang-btn" onclick="switchLang('en')" id="btn-en">ğŸ‡¬ğŸ‡§ English</button>
        </div>
    </div>

    <div id="chat-container">
        <div id="input-section">
            <textarea id="question" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..."></textarea>
            <div id="keyboard-toggle" onclick="toggleKeyboard()">âŒ¨ï¸ Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ù…ÙˆØ²</div>
            <div id="math-keyboard">
                <div class="keyboard-row">
                    <button onclick="insertSymbol('+')">+</button>
                    <button onclick="insertSymbol('-')">-</button>
                    <button onclick="insertSymbol('*')">Ã—</button>
                    <button onclick="insertSymbol('/')">Ã·</button>
                    <button onclick="insertSymbol('=')">=</button>
                    <button onclick="insertSymbol('^')">^</button>
                    <button onclick="insertSymbol('âˆš')">âˆš</button>
                </div>
                <div class="keyboard-row">
                    <button onclick="insertSymbol('Ï€')">Ï€</button>
                    <button onclick="insertSymbol('âˆ')">âˆ</button>
                    <button onclick="insertSymbol('Î£')">Î£</button>
                    <button onclick="insertSymbol('âˆ«')">âˆ«</button>
                    <button onclick="insertSymbol('Î¸')">Î¸</button>
                    <button onclick="insertSymbol('Î»')">Î»</button>
                </div>
                <div class="keyboard-row">
                    <button onclick="insertSymbol('Î±')">Î±</button>
                    <button onclick="insertSymbol('Î²')">Î²</button>
                    <button onclick="insertSymbol('Î³')">Î³</button>
                    <button onclick="insertSymbol('Î©')">Î©</button>
                    <button onclick="insertSymbol('Î¼')">Î¼</button>
                    <button onclick="insertSymbol('Â°')">Â°</button>
                </div>
            </div>
            <button id="solve-btn" onclick="sendQuestion()">ğŸ” Ø­Ù„ Ø§Ù„Ù…Ø³Ø£Ù„Ø©</button>
        </div>
        <div id="answer-section">
            <div class="domain-badge" id="domain-badge">
                <span data-ar="ğŸ§  ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø³Ø¤Ø§Ù„Ùƒ ÙƒÙ€" data-en="ğŸ§  Detected as">ğŸ§  ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø³Ø¤Ø§Ù„Ùƒ ÙƒÙ€</span>
                <strong id="domain-name">Ø±ÙŠØ§Ø¶ÙŠØ§Øª</strong>
                <span id="confidence-value"> Â· 98%</span>
            </div>
            <div class="solution-card">
                <div style="font-size: 22px; color: #1b3b6f; margin-bottom: 6px;" data-ar="ğŸ“‹ Ø§Ù„Ø­Ù„" data-en="ğŸ“‹ Solution">ğŸ“‹ Ø§Ù„Ø­Ù„</div>
                <div id="simplified-solution" data-ar="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù„ØªØ¨Ø¯Ø£" data-en="Enter your question">Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù„ØªØ¨Ø¯Ø£</div>
                <div class="note" data-ar="âœ¨ Ø³ÙŠØªÙ… Ø­Ù„ Ø§Ù„Ù…Ø³Ø£Ù„Ø© Ø¨Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ©" data-en="âœ¨ Highâ€‘accuracy solution">âœ¨ Ø³ÙŠØªÙ… Ø­Ù„ Ø§Ù„Ù…Ø³Ø£Ù„Ø© Ø¨Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ©</div>
            </div>
        </div>
    </div>

    <script>
        let currentLang = 'ar';

        function switchLang(lang) {
            currentLang = lang;
            document.getElementById('btn-ar').classList.toggle('active', lang === 'ar');
            document.getElementById('btn-en').classList.toggle('active', lang === 'en');

            document.querySelectorAll('[data-ar][data-en]').forEach(el => {
                el.innerText = el.getAttribute(`data-${lang}`);
            });

            const q = document.getElementById('question');
            q.placeholder = lang === 'ar' ? 'Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§...' : 'Type your question here...';

            const toggle = document.getElementById('keyboard-toggle');
            toggle.innerText = lang === 'ar' ? 'âŒ¨ï¸ Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ù…ÙˆØ²' : 'âŒ¨ï¸ Show keyboard';

            const solveBtn = document.getElementById('solve-btn');
            solveBtn.innerText = lang === 'ar' ? 'ğŸ” Ø­Ù„ Ø§Ù„Ù…Ø³Ø£Ù„Ø©' : 'ğŸ” Solve';

            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
        }

        function toggleKeyboard() {
            const kb = document.getElementById('math-keyboard');
            kb.style.display = kb.style.display === 'flex' ? 'none' : 'flex';
        }

        function insertSymbol(sym) {
            const q = document.getElementById('question');
            const start = q.selectionStart;
            const end = q.selectionEnd;
            q.value = q.value.slice(0, start) + sym + q.value.slice(end);
            q.focus();
        }

        function sendQuestion() {
            const q = document.getElementById('question').value.trim();
            if (!q) {
                alert(currentLang === 'ar' ? 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø¤Ø§Ù„' : 'Please enter a question');
                return;
            }

            const solutionDiv = document.getElementById('simplified-solution');
            solutionDiv.innerText = currentLang === 'ar' ? 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ù„...' : 'â³ Solving...';

            fetch('/api/solve', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ question: q, language: currentLang })
            })
            .then(r => r.json())
            .then(data => {
                solutionDiv.innerText = data.simple_answer || (currentLang === 'ar' ? 'ØªÙ… Ø§Ù„Ø­Ù„' : 'Solved');
                if (data.domain) document.getElementById('domain-name').innerText = data.domain;
                if (data.confidence) document.getElementById('confidence-value').innerText = ` Â· ${data.confidence}%`;
            })
            .catch(() => {
                solutionDiv.innerText = currentLang === 'ar' ? 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„' : 'âŒ Connection error';
            });
        }

        switchLang('ar');
    </script>
</body>
</html>
